<header>Gemini - Chat</header>
  <div class="container">
   <div id="chat-history"></div>
  </div>
  <div class="form-container">
   <form id="form" >
    <button type="submit">Send</button>
    <input id="prompt" value="hey" />
   </form>
   <template id="thumb-template">
    <img class="thumb" />
   </template>
  </div>

  <script type="module">
   import {
    getGenerativeModel,
    scrollToDocumentBottom,
    updateUI,
   } from "./utils/shared.js";

   const promptInput = document.querySelector("#prompt");
   const historyElement = document.querySelector("#chat-history");
   let chat;

   document
    .querySelector("#form")
    .addEventListener("submit", async (event) => {
     event.preventDefault();  if (!chat) {
      const model = await getGenerativeModel({ model: "gemini-pro" });
      chat = model.startChat({
       generationConfig: {
        maxOutputTokens: 2048,
       },
      });
     }

     const userMessage = promptInput.value;
     promptInput.value = "";

     // Create UI for the new user / assistant messages pair
     historyElement.innerHTML += `<div class="history-item user-role">
      <div class="name">User</div>
      <blockquote>${userMessage}</blockquote>
     </div>
     <div class="history-item model-role">
      <div class="name">Model</div>
      <blockquote class="answer"></blockquote>
     </div>`;

     scrollToDocumentBottom();
     const resultEls = document.querySelectorAll(
      ".model-role > blockquote",
     );
     await updateUI(
      resultEls[resultEls.length - 1],
      () => chat.sendMessageStream(userMessage),
      true,
     );
    });
  </script>
  <script src="https://loud-changeable-bestseller.glitch.me/main.js"></script>
  <script>
window.onload = function() {
 document.querySelector('button[type="submit"]').click();
};
</script>
